<%= render :partial => "query_report/search", locals: {report: @report} %>
<%= link_to_download_report_pdf %>
<%= link_to_download_report_csv %>

<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<div id='chart' style="margin-left:auto;margin-right:auto;width:600px;"></div>
<%#= render_chart(@report.chart.prepare, 'chart') if @report.chart %>

<br/>
<%# if @report.scopes.size > 0 %>
    <%#= link_to_with_scope('all', @report.current_scope) %>
    <%# @report.scopes.each do |scope| %>
        <%#= link_to_with_scope(scope, @report.current_scope) %>
    <%# end %>
<%# end %>
<br/>

<% if @report.records.size > 0 %>
    <table class="table table-bordered table-striped">
      <thead>
      <% @report.columns.each do |column| %>
          <th><%= sort_link(@report.search, column.name) %></th>
      <% end %>
      </thead>

      <tbody>
      <% @report.records.each do |record| %>
          <tr>
            <% @report.columns.each do |column| %>
                <td><%= record[column.humanize] %></td>
            <% end %>
          </tr>
      <% end %>
      </tbody>
    </table>
<% else %>
    <p>No record found</p>
<% end %>

<%= paginate @report.paginated_query if @report.paginate? %>